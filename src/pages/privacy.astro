---
import { Image, getImage } from "astro:assets";
import { marked } from 'marked';
import { gfmHeadingId } from "marked-gfm-heading-id";
import Layout from '@layouts/Layout.astro';
import Prose from '@components/Prose_privacy.astro';
import Back from "../components/Back.astro";
import Up from "../components/Up.astro";
import paper from "@assets/coc/paper.png";
import Tapes from '@components/Tapes.astro';
import plaque from "@assets/privacypolicy/plaque.png";

const optimizedBackgroundImage = await getImage({ src: paper, format:"avif" })

marked.use(gfmHeadingId());

const response = await fetch('https://raw.githubusercontent.com/snowpity/Mare-Fair-Policies/refs/heads/master/Privacy%20Policy.md');
const markdown = await response.text();
const content = marked.parse(markdown);

---

<Layout title="Privacy Policy | Mare Fair 2025">
  <Back />
  <Up />
  {/* Backstage Background */}
  <div class="flex flex-col justify-center items-center p-8 overflow-hidden h-full" style="filter: drop-shadow(5px 5px 0.5rem);">

    <div class="flex flex-col justify-center items-center p-8 h-full">
      <Image src={plaque} format="avif" alt="Privacy Policy" class="max-w-[50rem] w-full mb-10" width={800}/>
      <div id="row-container" class="flex lg:flex-row-reverse flex-col items-center content w-full">
      </div>
    </div>

    {/* Privacy Policy Content */}
        <div class="relative w-full max-w-4xl p-8 shadow-lg max-h-full bg-top min-w-[60rem] flex flex-wrap justify-center sm:bg-[length:60rem] bg-[length:50rem]" style={`background-image: url('${optimizedBackgroundImage.src}');`}>

        <Tapes/>

        <Prose>
          <div id="content-wrapper" class="mx-auto w-11/12">
            <div class="px-4 content reddit-sans">
              <article set:html={content} />
            </div>
          </div>
        </Prose>
      </div>
    )
  </div>
</Layout>

<style>
  :global(.prose thead tr:last-child) {
  border-bottom: .5rem solid transparent;
  }
  :global(li::marker) {
    color: #374151 !important;
  }
</style>

<style>
  /* To control the texts in ul li, etc, go to Prose.astro */
  .content {
  @apply sm:text-[1.5rem] text-[1.25rem] sm:leading-[2.056rem] leading-[1.711rem] mt-0
  }

  @media (min-width: 821px) {
  :global(.prose tr) {
  border-bottom: .38rem solid transparent;
  }
}

  @media (max-width: 820px) {
    #content-wrapper {
        width: 95vw;
    }
  :global(.prose tr) {
  border-bottom: .4rem solid transparent;
  }
}
</style>
